<!DOCTYPE html><!--Created by Clayton Begg at Byte--><?php    $CIType=$_GET["CIType"];    $CIcust=$_GET["CIcust"];    $CIname=$_GET["CIname"];    $CInotes=$_GET["CInotes"];        $PWname=$_POST["PWname"];    $PWuser=$_POST["PWuser"];    $PWpass=$_POST["PWpass"];    $PWType=$_POST["PWType"];    $PWnotes=$_POST["PWnotes"];        echo $PWname;    echo $PWuser;    echo $PWpass;    echo $PWType;    echo $PWnotes;                //API calls to ConnectWise    $GetTypesURL = "https://support.byte.com.au/v4_6_Release/apis/3.0/company/configurations/types?conditions=systemFlag=false+and+inactiveFlag=false&pageSize=200";    $CUurl = "https://support.byte.com.au/v4_6_Release/apis/3.0/company/companies?conditions=status/id=1+and+(type/id=1+or+type/id=36)&pageSize=300";       //Header to add to API calls    $header = array(        "Authorization: Basic Ynl0ZSs0ZkIzZHFyTGZ6blZGRkVuOmRjTjZjMjRqQ2NhNHFweG0=",        "X-cw-overridessl: True",        "Content-Type: Application/json",        "Conditions: company/name contains 'byte'"    );        $formType = 3;        if ($CIname!=NULL)     {        $formType = 4;        $data = array("name" => $CIname, "type" => Array("id" => $CIType), "company" => Array("id" => $CIcust), "notes" => $CInotes);                                                                            $data_string = json_encode($data);          $SubURL = "https://support.byte.com.au/v4_6_Release/apis/3.0/company/configurations";                $Subch = curl_init();            curl_setopt($Subch, CURLOPT_URL,$SubURL);            curl_setopt($Subch, CURLOPT_CUSTOMREQUEST, "POST");             curl_setopt($Subch, CURLOPT_POSTFIELDS, $data_string);              curl_setopt($Subch, CURLOPT_RETURNTRANSFER, true);            curl_setopt($Subch, CURLOPT_HTTPHEADER, $header);                $Subresponse = curl_exec($Subch);        $Subobject = json_decode($Subresponse, JSON_PRETTY_PRINT);                if (curl_errno($Subch)) {         print "Error: " . curl_error($Subch);         } else {         curl_close($Subch);        }    }        if ($CIType==NULL) { $formType = 0;}    if ($CIType==67) { $formType = 1;}    if ($CIType==63) { $formType = 1;}    if ($CIType==8) { $formType = 2;}
        //Initiate curl and set options    $Typesch = curl_init();        curl_setopt($Typesch, CURLOPT_URL,$GetTypesURL);        curl_setopt($Typesch, CURLOPT_RETURNTRANSFER, true);        curl_setopt($Typesch, CURLOPT_HTTPHEADER, $header);            if ($CIType!=NULL)    {    $CUch = curl_init();        curl_setopt($CUch, CURLOPT_URL,$CUurl);        curl_setopt($CUch, CURLOPT_RETURNTRANSFER, true);        curl_setopt($CUch, CURLOPT_HTTPHEADER, $header);    }    //Execute above curl    $CITresponse = curl_exec($Typesch);    $Custresponse = curl_exec($CUch);        //Store curl response as pretty json    $CITobject = json_decode($CITresponse, JSON_PRETTY_PRINT);    $Custobject = json_decode($Custresponse, JSON_PRETTY_PRINT);        //Check for curl errors, close curl session if no errors    if (curl_errno($Typesch)) {         print "Error: " . curl_error($Typesch);     } else {         curl_close($Typesch);     }     if (curl_errno($CUch)) {         print "Error: " . curl_error($CUch);     } else {         curl_close($CUch);    }
?><html>    <head>        <meta http-equiv="content-type" content="text/html; charset=utf-8" />        <title>CI Load</title>        <meta name="keywords" content="CI, Load" />        <meta name="description" content="Dashboard for the Security Operations Centre" />        <link href="styleSOC.css" rel="stylesheet" type="text/css" /> <link rel="stylesheet" type="text/css" media="all" href="jsDatePick_ltr.min.css" />    </head>    <body>        <!-- Top Banner -->        <div id="banner">            <table class="top">                <tr>                    <th>                    <img class="logo" src="/pics/Byte_Logo_RGB_Large_TRANS.png">                        </th>                    <td>                    <h1>CI Load</h1>                    <h6>ConnectWise CMDB</h6>                    </td>                </tr>            </table>         </div>        <div id="time">            <p><?php date_default_timezone_set("Australia/Melbourne"); echo date("l").", ".date("d/m/Y")." - ".date("h:i:sa"); ?></p>         </div>        <!-- Global Threats window -->        <div id="GlobalThreats">            <h2>Load Single CI</h2>                <div id="GlobalThreatsCon">                    <form name="SelCI" action="" method="GET" onSubmit='return validateSearchCMDB();'>                        <table>                            <tr><td></td></tr>                            <tr><td>                            <select name="CIType" Value="Select a Type" onChange="showUser(this.value)">                    <!-- <option value="">Select a CI Type</option> -->                                        <?php                     if ($CIType != NULL) { echo "<option value=\"".$CIType."\" selected>Choose another CI Type?</option>"; }                     foreach ($CITobject as $CIT)                        {                        echo "<option value=\"".$CIT['id']."\">".$CIT['name']."</option>";                        }                                             ?>                            </select>                            </td><td><input type="submit" value="OK"/></td>   </table>          </form>                    <?php                         if ($formType==0) {echo "Please Select a CI Type";}                        if ($formType==1)                         {                        echo "<form name=\"SubPW\" action=\"\" method=\"POST\" onSubmit=\"\">";                        echo "Enter CI Name: <input type=\"text\" value=\"\" name=\"PWname\" /></br>";                        echo "Enter Username: <input type=\"text\" value=\"\" name=\"PWuser\" /></br>";                        echo "Enter Password: <input type=\"text\" value=\"\" name=\"PWpass\" /></br>";                        echo "Notes: </br>";                        echo "<textarea name=\"PWnotes\" rows=\"3\" cols=\"59\"></textarea></br>";                        echo "<input type=\"hidden\" name=\"PWType\" value=\"".$CIType."\">";                        echo "<input type=\"submit\" value=\"Submit Password\"/>";                        echo "</form>";                        }                        if ($formType==2) {echo "Working on Server section";}                        if ($formType==3)                         {                        echo "<form name=\"SubCI\" action=\"\" method=\"GET\" onSubmit=\"\">";                        echo "Enter CI Name: <input type=\"text\" value=\"\" name=\"CIname\" /></br>";                        echo "Enter Customer: <select name=\"CIcust\" Value=\"Select a Customer\" onChange=\"showUser(this.value)\">";   echo "<!-- <option value=\"\">Select a Customer</option> -->";                                            foreach ($Custobject as $Cust)                        {                        echo "<option value=\"".$Cust['id']."\">".$Cust['name']."</option>";                        }                                                 echo "</select></br>";                        echo "Notes: </br>";                        echo "<textarea name=\"CInotes\" rows=\"4\" cols=\"59\"></textarea></br>";                        echo "<input type=\"hidden\" name=\"CIType\" value=\"".$CIType."\">";                        echo "<input type=\"submit\" value=\"Submit CI\"/>";                        echo "</form>";                        }                    //echo $data_string."</br>";                    if ($formType==4) {echo "CI Submitted with name: ".$CIname;}                    ?>                </div>        </div>        <!-- Alerts window -->        <div id="Alerts">            <h2>Load Multiple CIs</h2>                <div id="AlertsCon">
                </div>        </div>    
        <!-- Author footer at bottom of page -->        <div id="footer">            <p></p>            <p>Developed by Clayton Begg: <i>claytonb@byte.com.au</i> - Version 0.1</p>        </div>    </body></html>



ADDING STUFF